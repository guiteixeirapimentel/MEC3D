#pragma once
#include <iostream>
#include "Triangulo.h"
#include "Matriz.h"

#include "MalhaTriangularLinearDescontinua.h"

#include "HammerLinearDescTriangleIntegration.h"
#include "SingularIntegrationLinearDescTriangle.h"

#include "UStarFunNoSing.h"
#include "PStarFunNoSing.h"

#include "MathUtils.h"

#include "Timer.h"

#include "Tesselation.hpp"

int ElementoLinear(const MalhaTriangularLinearDescontinua& malha, const double E, const double v)
{
    const double G = E / (2 * (1.0 + v));

    Timer timer;

    const int idtTotal = timer.SetTimer("Tempo total programa");
    const int idtMalha = timer.SetTimer("Criacao de malha");
    const int idtMatrizHG = timer.SetTimer("Criacao das Matrizes H e G");
    const int idtRearrSist = timer.SetTimer("Rearranjo de matrizes");
    const int idtSolSistLin = timer.SetTimer("Solucao sistema linear");

    timer.Tick(idtTotal);

    timer.Tick(idtMalha);

    //constexpr double kk = 0.1;
    //std::vector<Ponto> pontos = {
    //    {0.0000*kk, 0.0000*kk, 4.0000},
    //    {2.0000*kk, 0.0000*kk, 4.0000},
    //    {0.0000*kk, 2.0000*kk, 4.0000},
    //    {0.0000*kk, 2.0000*kk, 4.0000},
    //    {2.0000*kk, 0.0000*kk, 4.0000},
    //    {2.0000*kk, 2.0000*kk, 4.0000},
    //    {0.0000*kk, 0.0000*kk, 0.0000},
    //    {0.0000*kk, 2.0000*kk, 0.0000},
    //    {2.0000*kk, 0.0000*kk, 0.0000},
    //    {0.0000*kk, 2.0000*kk, 0.0000},
    //    {2.0000*kk, 2.0000*kk, 0.0000},
    //    {2.0000*kk, 0.0000*kk, 0.0000},
    //    {2.0000*kk, 0.0000*kk, 4.0000},
    //    {2.0000*kk, 0.0000*kk, 0.0000},
    //    {2.0000*kk, 2.0000*kk, 0.0000},
    //    {2.0000*kk, 0.0000*kk, 4.0000},
    //    {2.0000*kk, 2.0000*kk, 0.0000},
    //    {2.0000*kk, 2.0000*kk, 4.0000},
    //    {0.0000*kk, 2.0000*kk, 4.0000},
    //    {0.0000*kk, 2.0000*kk, 0.0000},
    //    {0.0000*kk, 0.0000*kk, 0.0000},
    //    {0.0000*kk, 2.0000*kk, 4.0000},
    //    {0.0000*kk, 0.0000*kk, 0.0000},
    //    {0.0000*kk, 0.0000*kk, 4.0000},
    //    {2.0000*kk, 2.0000*kk, 4.0000},
    //    {2.0000*kk, 2.0000*kk, 0.0000},
    //    {0.0000*kk, 2.0000*kk, 0.0000},
    //    {2.0000*kk, 2.0000*kk, 4.0000},
    //    {0.0000*kk, 2.0000*kk, 0.0000},
    //    {0.0000*kk, 2.0000*kk, 4.0000},
    //    {0.0000*kk, 0.0000*kk, 0.0000},
    //    {2.0000*kk, 0.0000*kk, 0.0000},
    //    {0.0000*kk, 0.0000*kk, 4.0000},
    //    {0.0000*kk, 0.0000*kk, 4.0000},
    //    {2.0000*kk, 0.0000*kk, 0.0000},
    //    {2.0000*kk, 0.0000*kk, 4.0000}
    //};
    //std::vector<InstElemento> elementos =
    //{
    // {1,  2,  3},
    // {4,  5,  6},
    // {7,  8,  9},
    // {10, 11, 12},
    // {13, 14, 15},
    // {16, 17, 18},
    // {19, 20, 21},
    // {22, 23, 24},
    // {25, 26, 27},
    // {28, 29, 30},
    // {31, 32, 33},
    // {34, 35, 36}
    //};
    //std::vector<CondContorno> deslPrescs =
    //{
    //    { 3,  3,  0 },
    //    { 4,  3,  0 },
    //    { 3,  2,  0 },
    //    { 4,  2,  0 },
    //    { 3,  1,  0 },
    //    { 4,  1,  0 }
    //};
    //constexpr double P = 4.0e-6 / (kk * kk * 2.0 * 2.0);
    //constexpr double F = P * (kk * 2.0 * kk * 2.0);
    //std::vector<CondContorno> forcsPrescs =
    //{
    //    { 1,  2,  P },
    //    { 2,  2,  P }/*,
    //    { 3,  3,  -P },
    //    { 4,  3,  -P }*/
    //};

//    constexpr double k = 1.0;
//    constexpr double k2 = 1.0;
//    std::vector<Ponto> pontos = 
//    {
//
//    {0.0000*k, 2.0000*k, 4.0000*k2},
//    {0.0000*k, 0.0000*k, 4.0000*k2},
//    {1.0000*k, 1.0000*k, 4.0000*k2},
//    {2.0000*k, 2.0000*k, 4.0000*k2},
//    {0.0000*k, 2.0000*k, 4.0000*k2},
//    {1.0000*k, 1.0000*k, 4.0000*k2},
//    {2.0000*k, 0.0000*k, 4.0000*k2},
//    {2.0000*k, 2.0000*k, 4.0000*k2},
//    {1.0000*k, 1.0000*k, 4.0000*k2},
//    {0.0000*k, 0.0000*k, 4.0000*k2},
//    {2.0000*k, 0.0000*k, 4.0000*k2},
//    {1.0000*k, 1.0000*k, 4.0000*k2},
//    {2.0000*k, 2.0000*k, 0.0000*k2},
//    {2.0000*k, 0.0000*k, 0.0000*k2},
//    {1.0000*k, 1.0000*k, 0.0000*k2},
//    {0.0000*k, 2.0000*k, 0.0000*k2},
//    {2.0000*k, 2.0000*k, 0.0000*k2},
//    {1.0000*k, 1.0000*k, 0.0000*k2},
//    {0.0000*k, 0.0000*k, 0.0000*k2},
//    {0.0000*k, 2.0000*k, 0.0000*k2},
//    {1.0000*k, 1.0000*k, 0.0000*k2},
//    {0.0000*k, 0.0000*k, 0.0000*k2},
//    {1.0000*k, 1.0000*k, 0.0000*k2},
//    {2.0000*k, 0.0000*k, 0.0000*k2},
//    {2*k, 2*k, 2*k2},
//    {2*k, 1*k, 1*k2},
//    {2*k, 2*k, 0*k2},
//    {2*k, 0*k, 2*k2},
//    {2*k, 1*k, 1*k2},
//    {2*k, 2*k, 2*k2},
//    {2*k, 0*k, 2*k2},
//    {2*k, 0*k, 0*k2},
//    {2*k, 1*k, 1*k2},
//    {2*k, 1*k, 1*k2},
//    {2*k, 0*k, 0*k2},
//    {2*k, 2*k, 0*k2},
//    {2*k, 2*k, 4*k2},
//    {2*k, 1*k, 3*k2},
//    {2*k, 2*k, 2*k2},
//    {2*k, 0*k, 4*k2},
//    {2*k, 1*k, 3*k2},
//    {2*k, 2*k, 4*k2},
//    {2*k, 0*k, 4*k2},
//    {2*k, 0*k, 2*k2},
//    {2*k, 1*k, 3*k2},
//    {2*k, 1*k, 3*k2},
//    {2*k, 0*k, 2*k2},
//    {2*k, 2*k, 2*k2},
//    {0*k, 0*k, 2*k2},
//    {0*k, 1*k, 1*k2},
//    {0*k, 0*k, 0*k2},
//    {0*k, 1*k, 1*k2},
//    {0*k, 0*k, 2*k2},
//    {0*k, 2*k, 2*k2},
//    {0*k, 2*k, 2*k2},
//    {0*k, 2*k, 0*k2},
//    {0*k, 1*k, 1*k2},
//    {0*k, 1*k, 1*k2},
//    {0*k, 2*k, 0*k2},
//    {0*k, 0*k, 0*k2},
//    {0*k, 0*k, 4*k2},
//    {0*k, 1*k, 3*k2},
//    {0*k, 0*k, 2*k2},
//    {0*k, 1*k, 3*k2},
//    {0*k, 0*k, 4*k2},
//    {0*k, 2*k, 4*k2},
//    {0*k, 2*k, 4*k2},
//    {0*k, 2*k, 2*k2},
//    {0*k, 1*k, 3*k2},
//    {0*k, 1*k, 3*k2},
//    {0*k, 2*k, 2*k2},
//    {0*k, 0*k, 2*k2},
//    {0*k, 2*k, 0*k2},
//    {0*k, 2*k, 2*k2},
//    {1*k, 2*k, 1*k2},
//    {1*k, 2*k, 1*k2},
//    {2*k, 2*k, 0*k2},
//    {0*k, 2*k, 0*k2},
//    {2*k, 2*k, 2*k2},
//    {2*k, 2*k, 0*k2},
//    {1*k, 2*k, 1*k2},
//    {1*k, 2*k, 1*k2},
//    {0*k, 2*k, 2*k2},
//    {2*k, 2*k, 2*k2},
//    {0*k, 2*k, 4*k2},
//    {1*k, 2*k, 3*k2},
//    {0*k, 2*k, 2*k2},
//    {2*k, 2*k, 4*k2},
//    {1*k, 2*k, 3*k2},
//    {0*k, 2*k, 4*k2},
//    {2*k, 2*k, 4*k2},
//    {2*k, 2*k, 2*k2},
//    {1*k, 2*k, 3*k2},
//    {1*k, 2*k, 3*k2},
//    {2*k, 2*k, 2*k2},
//    {0*k, 2*k, 2*k2},
//    {2*k, 0*k, 2*k2},
//    {1*k, 0*k, 1*k2},
//    {2*k, 0*k, 0*k2},
//    {0*k, 0*k, 2*k2},
//    {1*k, 0*k, 1*k2},
//    {2*k, 0*k, 2*k2},
//    {0*k, 0*k, 2*k2},
//    {0*k, 0*k, 0*k2},
//    {1*k, 0*k, 1*k2},
//    {1*k, 0*k, 1*k2},
//    {0*k, 0*k, 0*k2},
//    {2*k, 0*k, 0*k2},
//    {2*k, 0*k, 4*k2},
//    {1*k, 0*k, 3*k2},
//    {2*k, 0*k, 2*k2},
//    {0*k, 0*k, 4*k2},
//    {1*k, 0*k, 3*k2},
//    {2*k, 0*k, 4*k2},
//    {0*k, 0*k, 4*k2},
//    {0*k, 0*k, 2*k2},
//    {1*k, 0*k, 3*k2},
//    {1*k, 0*k, 3*k2},
//    {0*k, 0*k, 2*k2},
//    {2*k, 0*k, 2*k2 } 
//};
//
//    std::vector<InstElemento> elementos = 
//    {
//    {1, 2, 3},
//    {4, 5, 6},
//    {7, 8, 9},
//    {10, 11, 12},
//    {13, 14, 15},
//    {16, 17, 18},
//    {19, 20, 21},
//    {22, 23, 24},
//    {25, 26, 27},
//    { 28, 29, 30},
//    { 31, 32, 33},
//    { 34, 35, 36},
//    { 37, 38, 39},
//    { 40, 41, 42},
//    { 43, 44, 45},
//    { 46, 47, 48},
//    { 49, 50, 51},
//    { 52, 53, 54},
//    { 55, 56, 57},
//    { 58, 59, 60},
//    { 61, 62, 63},
//    { 64, 65, 66},
//    { 67, 68, 69},
//    { 70, 71, 72},
//    { 73, 74, 75},
//    { 76, 77, 78},
//    { 79, 80, 81},
//    { 82, 83, 84},
//    { 85, 86, 87},
//    { 88, 89, 90},
//    { 91, 92, 93},
//    { 94, 95, 96},
//    { 97, 98, 99},
//    { 100, 101, 102},
//    { 103, 104, 105},
//    { 106, 107, 108},
//    { 109, 110, 111},
//    { 112, 113, 114},
//    { 115, 116, 117},
//    { 118, 119, 120} };
//    std::vector<CondContorno> deslPrescs =
//    {
//        { 5,  3,  0 },
//        { 6,  3,  0 },
//        { 7,  3,  0 },
//        { 8,  3,  0 },
//        { 5,  2,  0 },
//        { 6,  2,  0 },
//        { 7,  2,  0 },
//        { 8,  2,  0 },
//        { 5,  1,  0 },
//        { 6,  1,  0 },
//        { 7,  1,  0 },
//        { 8,  1,  0 }
//    };
//    std::vector<CondContorno> forcsPrescs =
//    {
//        { 1,  3,   1.0 },
//        { 2,  3,   1.0 },
//        { 3,  3,   1.0 },
//        { 4,  3,   1.0 }/*,
//        { 5,  3,  -1.0 },
//        { 6,  3,  -1.0 },
//        { 7,  3,  -1.0 },
//        { 8,  3,  -1.0 }*/
//    };
//
//    //std::vector<Ponto> pontos =
//    //{
//    //    // topo
//    //    {0.0000, 2.0000, 20.0000},
//    //    {0.0000, 0.0000, 20.0000},
//    //    {1.0000, 1.0000, 20.0000},
//    //    {2.0000, 2.0000, 20.0000},
//    //    {0.0000, 2.0000, 20.0000},
//    //    {1.0000, 1.0000, 20.0000},
//    //    {2.0000, 0.0000, 20.0000},
//    //    {2.0000, 2.0000, 20.0000},
//    //    {1.0000, 1.0000, 20.0000},
//    //    {0.0000, 0.0000, 20.0000},
//    //    {2.0000, 0.0000, 20.0000},
//    //    {1.0000, 1.0000, 20.0000},
//    //    //baixo
//    //    {2.0000, 2.0000, 0.0000},
//    //    {2.0000, 0.0000, 0.0000},
//    //    {1.0000, 1.0000, 0.0000},
//    //    {0.0000, 2.0000, 0.0000},
//    //    {2.0000, 2.0000, 0.0000},
//    //    {1.0000, 1.0000, 0.0000},
//    //    {0.0000, 0.0000, 0.0000},
//    //    {0.0000, 2.0000, 0.0000},
//    //    {1.0000, 1.0000, 0.0000},
//    //    {0.0000, 0.0000, 0.0000},
//    //    {1.0000, 1.0000, 0.0000},
//    //    {2.0000, 0.0000, 0.0000},
//    //    {2.0, 2.0000, 2.0000 + 0.0000},
//    //    {2.0, 1.0000, 1.0000 + 0.0000},
//    //    {2.0, 2.0000, 0.0000 + 0.0000},
//    //    {2.0, 0.0000, 2.0000 + 0.0000},
//    //    {2.0, 1.0000, 1.0000 + 0.0000},
//    //    {2.0, 2.0000, 2.0000 + 0.0000},
//    //    {2.0, 0.0000, 2.0000 + 0.0000},
//    //    {2.0, 0.0000, 0.0000 + 0.0000},
//    //    {2.0, 1.0000, 1.0000 + 0.0000},
//    //    {2.0, 1.0000, 1.0000 + 0.0000},
//    //    {2.0, 0.0000, 0.0000 + 0.0000},
//    //    {2.0, 2.0000, 0.0000 + 0.0000},
//    //    {2.0, 2.0000, 4.0000 + 0.0000},
//    //    {2.0, 1.0000, 3.0000 + 0.0000},
//    //    {2.0, 2.0000, 2.0000 + 0.0000},
//    //    {2.0, 0.0000, 4.0000 + 0.0000},
//    //    {2.0, 1.0000, 3.0000 + 0.0000},
//    //    {2.0, 2.0000, 4.0000 + 0.0000},
//    //    {2.0, 0.0000, 4.0000 + 0.0000},
//    //    {2.0, 0.0000, 2.0000 + 0.0000},
//    //    {2.0, 1.0000, 3.0000 + 0.0000},
//    //    {2.0, 1.0000, 3.0000 + 0.0000},
//    //    {2.0, 0.0000, 2.0000 + 0.0000},
//    //    {2.0, 2.0000, 2.0000 + 0.0000},
//    //    {0.0, 0.0000, 2.0000 + 0.0000},
//    //    {0.0, 1.0000, 1.0000 + 0.0000},
//    //    {0.0, 0.0000, 0.0000 + 0.0000},
//    //    {0.0, 1.0000, 1.0000 + 0.0000},
//    //    {0.0, 0.0000, 2.0000 + 0.0000},
//    //    {0.0, 2.0000, 2.0000 + 0.0000},
//    //    {0.0, 2.0000, 2.0000 + 0.0000},
//    //    {0.0, 2.0000, 0.0000 + 0.0000},
//    //    {0.0, 1.0000, 1.0000 + 0.0000},
//    //    {0.0, 1.0000, 1.0000 + 0.0000},
//    //    {0.0, 2.0000, 0.0000 + 0.0000},
//    //    {0.0, 0.0000, 0.0000 + 0.0000},
//    //    {0.0, 0.0000, 4.0000 + 0.0000},
//    //    {0.0, 1.0000, 3.0000 + 0.0000},
//    //    {0.0, 0.0000, 2.0000 + 0.0000},
//    //    {0.0, 1.0000, 3.0000 + 0.0000},
//    //    {0.0, 0.0000, 4.0000 + 0.0000},
//    //    {0.0, 2.0000, 4.0000 + 0.0000},
//    //    {0.0, 2.0000, 4.0000 + 0.0000},
//    //    {0.0, 2.0000, 2.0000 + 0.0000},
//    //    {0.0, 1.0000, 3.0000 + 0.0000},
//    //    {0.0, 1.0000, 3.0000 + 0.0000},
//    //    {0.0, 2.0000, 2.0000 + 0.0000},
//    //    {0.0, 0.0000, 2.0000 + 0.0000},
//    //    {0.0, 2.0000, 0.0000 + 0.0000},
//    //    {0.0, 2.0000, 2.0000 + 0.0000},
//    //    {1.0, 2.0000, 1.0000 + 0.0000},
//    //    {1.0, 2.0000, 1.0000 + 0.0000},
//    //    {2.0, 2.0000, 0.0000 + 0.0000},
//    //    {0.0, 2.0000, 0.0000 + 0.0000},
//    //    {2.0, 2.0000, 2.0000 + 0.0000},
//    //    {2.0, 2.0000, 0.0000 + 0.0000},
//    //    {1.0, 2.0000, 1.0000 + 0.0000},
//    //    {1.0, 2.0000, 1.0000 + 0.0000},
//    //    {0.0, 2.0000, 2.0000 + 0.0000},
//    //    {2.0, 2.0000, 2.0000 + 0.0000},
//    //    {0.0, 2.0000, 4.0000 + 0.0000},
//    //    {1.0, 2.0000, 3.0000 + 0.0000},
//    //    {0.0, 2.0000, 2.0000 + 0.0000},
//    //    {2.0, 2.0000, 4.0000 + 0.0000},
//    //    {1.0, 2.0000, 3.0000 + 0.0000},
//    //    {0.0, 2.0000, 4.0000 + 0.0000},
//    //    {2.0, 2.0000, 4.0000 + 0.0000},
//    //    {2.0, 2.0000, 2.0000 + 0.0000},
//    //    {1.0, 2.0000, 3.0000 + 0.0000},
//    //    {1.0, 2.0000, 3.0000 + 0.0000},
//    //    {2.0, 2.0000, 2.0000 + 0.0000},
//    //    {0.0, 2.0000, 2.0000 + 0.0000},
//    //    {2.0, 0.0000, 2.0000 + 0.0000},
//    //    {1.0, 0.0000, 1.0000 + 0.0000},
//    //    {2.0, 0.0000, 0.0000 + 0.0000},
//    //    {0.0, 0.0000, 2.0000 + 0.0000},
//    //    {1.0, 0.0000, 1.0000 + 0.0000},
//    //    {2.0, 0.0000, 2.0000 + 0.0000},
//    //    {0.0, 0.0000, 2.0000 + 0.0000},
//    //    {0.0, 0.0000, 0.0000 + 0.0000},
//    //    {1.0, 0.0000, 1.0000 + 0.0000},
//    //    {1.0, 0.0000, 1.0000 + 0.0000},
//    //    {0.0, 0.0000, 0.0000 + 0.0000},
//    //    {2.0, 0.0000, 0.0000 + 0.0000},
//    //    {2.0, 0.0000, 4.0000 + 0.0000},
//    //    {1.0, 0.0000, 3.0000 + 0.0000},
//    //    {2.0, 0.0000, 2.0000 + 0.0000},
//    //    {0.0, 0.0000, 4.0000 + 0.0000},
//    //    {1.0, 0.0000, 3.0000 + 0.0000},
//    //    {2.0, 0.0000, 4.0000 + 0.0000},
//    //    {0.0, 0.0000, 4.0000 + 0.0000},
//    //    {0.0, 0.0000, 2.0000 + 0.0000},
//    //    {1.0, 0.0000, 3.0000 + 0.0000},
//    //    {1.0, 0.0000, 3.0000 + 0.0000},
//    //    {0.0, 0.0000, 2.0000 + 0.0000},
//    //    {2.0, 0.0000, 2.0000 + 0.0000},
//    //    {2.0, 2.0000, 2.0000 + 4.0000},
//    //    {2.0, 1.0000, 1.0000 + 4.0000},
//    //    {2.0, 2.0000, 0.0000 + 4.0000},
//    //    {2.0, 0.0000, 2.0000 + 4.0000},
//    //    {2.0, 1.0000, 1.0000 + 4.0000},
//    //    {2.0, 2.0000, 2.0000 + 4.0000},
//    //    {2.0, 0.0000, 2.0000 + 4.0000},
//    //    {2.0, 0.0000, 0.0000 + 4.0000},
//    //    {2.0, 1.0000, 1.0000 + 4.0000},
//    //    {2.0, 1.0000, 1.0000 + 4.0000},
//    //    {2.0, 0.0000, 0.0000 + 4.0000},
//    //    {2.0, 2.0000, 0.0000 + 4.0000},
//    //    {2.0, 2.0000, 4.0000 + 4.0000},
//    //    {2.0, 1.0000, 3.0000 + 4.0000},
//    //    {2.0, 2.0000, 2.0000 + 4.0000},
//    //    {2.0, 0.0000, 4.0000 + 4.0000},
//    //    {2.0, 1.0000, 3.0000 + 4.0000},
//    //    {2.0, 2.0000, 4.0000 + 4.0000},
//    //    {2.0, 0.0000, 4.0000 + 4.0000},
//    //    {2.0, 0.0000, 2.0000 + 4.0000},
//    //    {2.0, 1.0000, 3.0000 + 4.0000},
//    //    {2.0, 1.0000, 3.0000 + 4.0000},
//    //    {2.0, 0.0000, 2.0000 + 4.0000},
//    //    {2.0, 2.0000, 2.0000 + 4.0000},
//    //    {0.0, 0.0000, 2.0000 + 4.0000},
//    //    {0.0, 1.0000, 1.0000 + 4.0000},
//    //    {0.0, 0.0000, 0.0000 + 4.0000},
//    //    {0.0, 1.0000, 1.0000 + 4.0000},
//    //    {0.0, 0.0000, 2.0000 + 4.0000},
//    //    {0.0, 2.0000, 2.0000 + 4.0000},
//    //    {0.0, 2.0000, 2.0000 + 4.0000},
//    //    {0.0, 2.0000, 0.0000 + 4.0000},
//    //    {0.0, 1.0000, 1.0000 + 4.0000},
//    //    {0.0, 1.0000, 1.0000 + 4.0000},
//    //    {0.0, 2.0000, 0.0000 + 4.0000},
//    //    {0.0, 0.0000, 0.0000 + 4.0000},
//    //    {0.0, 0.0000, 4.0000 + 4.0000},
//    //    {0.0, 1.0000, 3.0000 + 4.0000},
//    //    {0.0, 0.0000, 2.0000 + 4.0000},
//    //    {0.0, 1.0000, 3.0000 + 4.0000},
//    //    {0.0, 0.0000, 4.0000 + 4.0000},
//    //    {0.0, 2.0000, 4.0000 + 4.0000},
//    //    {0.0, 2.0000, 4.0000 + 4.0000},
//    //    {0.0, 2.0000, 2.0000 + 4.0000},
//    //    {0.0, 1.0000, 3.0000 + 4.0000},
//    //    {0.0, 1.0000, 3.0000 + 4.0000},
//    //    {0.0, 2.0000, 2.0000 + 4.0000},
//    //    {0.0, 0.0000, 2.0000 + 4.0000},
//    //    {0.0, 2.0000, 0.0000 + 4.0000},
//    //    {0.0, 2.0000, 2.0000 + 4.0000},
//    //    {1.0, 2.0000, 1.0000 + 4.0000},
//    //    {1.0, 2.0000, 1.0000 + 4.0000},
//    //    {2.0, 2.0000, 0.0000 + 4.0000},
//    //    {0.0, 2.0000, 0.0000 + 4.0000},
//    //    {2.0, 2.0000, 2.0000 + 4.0000},
//    //    {2.0, 2.0000, 0.0000 + 4.0000},
//    //    {1.0, 2.0000, 1.0000 + 4.0000},
//    //    {1.0, 2.0000, 1.0000 + 4.0000},
//    //    {0.0, 2.0000, 2.0000 + 4.0000},
//    //    {2.0, 2.0000, 2.0000 + 4.0000},
//    //    {0.0, 2.0000, 4.0000 + 4.0000},
//    //    {1.0, 2.0000, 3.0000 + 4.0000},
//    //    {0.0, 2.0000, 2.0000 + 4.0000},
//    //    {2.0, 2.0000, 4.0000 + 4.0000},
//    //    {1.0, 2.0000, 3.0000 + 4.0000},
//    //    {0.0, 2.0000, 4.0000 + 4.0000},
//    //    {2.0, 2.0000, 4.0000 + 4.0000},
//    //    {2.0, 2.0000, 2.0000 + 4.0000},
//    //    {1.0, 2.0000, 3.0000 + 4.0000},
//    //    {1.0, 2.0000, 3.0000 + 4.0000},
//    //    {2.0, 2.0000, 2.0000 + 4.0000},
//    //    {0.0, 2.0000, 2.0000 + 4.0000},
//    //    {2.0, 0.0000, 2.0000 + 4.0000},
//    //    {1.0, 0.0000, 1.0000 + 4.0000},
//    //    {2.0, 0.0000, 0.0000 + 4.0000},
//    //    {0.0, 0.0000, 2.0000 + 4.0000},
//    //    {1.0, 0.0000, 1.0000 + 4.0000},
//    //    {2.0, 0.0000, 2.0000 + 4.0000},
//    //    {0.0, 0.0000, 2.0000 + 4.0000},
//    //    {0.0, 0.0000, 0.0000 + 4.0000},
//    //    {1.0, 0.0000, 1.0000 + 4.0000},
//    //    {1.0, 0.0000, 1.0000 + 4.0000},
//    //    {0.0, 0.0000, 0.0000 + 4.0000},
//    //    {2.0, 0.0000, 0.0000 + 4.0000},
//    //    {2.0, 0.0000, 4.0000 + 4.0000},
//    //    {1.0, 0.0000, 3.0000 + 4.0000},
//    //    {2.0, 0.0000, 2.0000 + 4.0000},
//    //    {0.0, 0.0000, 4.0000 + 4.0000},
//    //    {1.0, 0.0000, 3.0000 + 4.0000},
//    //    {2.0, 0.0000, 4.0000 + 4.0000},
//    //    {0.0, 0.0000, 4.0000 + 4.0000},
//    //    {0.0, 0.0000, 2.0000 + 4.0000},
//    //    {1.0, 0.0000, 3.0000 + 4.0000},
//    //    {1.0, 0.0000, 3.0000 + 4.0000},
//    //    {0.0, 0.0000, 2.0000 + 4.0000},
//    //    {2.0, 0.0000, 2.0000 + 4.0000},
//    //    {2.0, 2.0000, 2.0000 + 8.0000},
//    //    {2.0, 1.0000, 1.0000 + 8.0000},
//    //    {2.0, 2.0000, 0.0000 + 8.0000},
//    //    {2.0, 0.0000, 2.0000 + 8.0000},
//    //    {2.0, 1.0000, 1.0000 + 8.0000},
//    //    {2.0, 2.0000, 2.0000 + 8.0000},
//    //    {2.0, 0.0000, 2.0000 + 8.0000},
//    //    {2.0, 0.0000, 0.0000 + 8.0000},
//    //    {2.0, 1.0000, 1.0000 + 8.0000},
//    //    {2.0, 1.0000, 1.0000 + 8.0000},
//    //    {2.0, 0.0000, 0.0000 + 8.0000},
//    //    {2.0, 2.0000, 0.0000 + 8.0000},
//    //    {2.0, 2.0000, 4.0000 + 8.0000},
//    //    {2.0, 1.0000, 3.0000 + 8.0000},
//    //    {2.0, 2.0000, 2.0000 + 8.0000},
//    //    {2.0, 0.0000, 4.0000 + 8.0000},
//    //    {2.0, 1.0000, 3.0000 + 8.0000},
//    //    {2.0, 2.0000, 4.0000 + 8.0000},
//    //    {2.0, 0.0000, 4.0000 + 8.0000},
//    //    {2.0, 0.0000, 2.0000 + 8.0000},
//    //    {2.0, 1.0000, 3.0000 + 8.0000},
//    //    {2.0, 1.0000, 3.0000 + 8.0000},
//    //    {2.0, 0.0000, 2.0000 + 8.0000},
//    //    {2.0, 2.0000, 2.0000 + 8.0000},
//    //    {0.0, 0.0000, 2.0000 + 8.0000},
//    //    {0.0, 1.0000, 1.0000 + 8.0000},
//    //    {0.0, 0.0000, 0.0000 + 8.0000},
//    //    {0.0, 1.0000, 1.0000 + 8.0000},
//    //    {0.0, 0.0000, 2.0000 + 8.0000},
//    //    {0.0, 2.0000, 2.0000 + 8.0000},
//    //    {0.0, 2.0000, 2.0000 + 8.0000},
//    //    {0.0, 2.0000, 0.0000 + 8.0000},
//    //    {0.0, 1.0000, 1.0000 + 8.0000},
//    //    {0.0, 1.0000, 1.0000 + 8.0000},
//    //    {0.0, 2.0000, 0.0000 + 8.0000},
//    //    {0.0, 0.0000, 0.0000 + 8.0000},
//    //    {0.0, 0.0000, 4.0000 + 8.0000},
//    //    {0.0, 1.0000, 3.0000 + 8.0000},
//    //    {0.0, 0.0000, 2.0000 + 8.0000},
//    //    {0.0, 1.0000, 3.0000 + 8.0000},
//    //    {0.0, 0.0000, 4.0000 + 8.0000},
//    //    {0.0, 2.0000, 4.0000 + 8.0000},
//    //    {0.0, 2.0000, 4.0000 + 8.0000},
//    //    {0.0, 2.0000, 2.0000 + 8.0000},
//    //    {0.0, 1.0000, 3.0000 + 8.0000},
//    //    {0.0, 1.0000, 3.0000 + 8.0000},
//    //    {0.0, 2.0000, 2.0000 + 8.0000},
//    //    {0.0, 0.0000, 2.0000 + 8.0000},
//    //    {0.0, 2.0000, 0.0000 + 8.0000},
//    //    {0.0, 2.0000, 2.0000 + 8.0000},
//    //    {1.0, 2.0000, 1.0000 + 8.0000},
//    //    {1.0, 2.0000, 1.0000 + 8.0000},
//    //    {2.0, 2.0000, 0.0000 + 8.0000},
//    //    {0.0, 2.0000, 0.0000 + 8.0000},
//    //    {2.0, 2.0000, 2.0000 + 8.0000},
//    //    {2.0, 2.0000, 0.0000 + 8.0000},
//    //    {1.0, 2.0000, 1.0000 + 8.0000},
//    //    {1.0, 2.0000, 1.0000 + 8.0000},
//    //    {0.0, 2.0000, 2.0000 + 8.0000},
//    //    {2.0, 2.0000, 2.0000 + 8.0000},
//    //    {0.0, 2.0000, 4.0000 + 8.0000},
//    //    {1.0, 2.0000, 3.0000 + 8.0000},
//    //    {0.0, 2.0000, 2.0000 + 8.0000},
//    //    {2.0, 2.0000, 4.0000 + 8.0000},
//    //    {1.0, 2.0000, 3.0000 + 8.0000},
//    //    {0.0, 2.0000, 4.0000 + 8.0000},
//    //    {2.0, 2.0000, 4.0000 + 8.0000},
//    //    {2.0, 2.0000, 2.0000 + 8.0000},
//    //    {1.0, 2.0000, 3.0000 + 8.0000},
//    //    {1.0, 2.0000, 3.0000 + 8.0000},
//    //    {2.0, 2.0000, 2.0000 + 8.0000},
//    //    {0.0, 2.0000, 2.0000 + 8.0000},
//    //    {2.0, 0.0000, 2.0000 + 8.0000},
//    //    {1.0, 0.0000, 1.0000 + 8.0000},
//    //    {2.0, 0.0000, 0.0000 + 8.0000},
//    //    {0.0, 0.0000, 2.0000 + 8.0000},
//    //    {1.0, 0.0000, 1.0000 + 8.0000},
//    //    {2.0, 0.0000, 2.0000 + 8.0000},
//    //    {0.0, 0.0000, 2.0000 + 8.0000},
//    //    {0.0, 0.0000, 0.0000 + 8.0000},
//    //    {1.0, 0.0000, 1.0000 + 8.0000},
//    //    {1.0, 0.0000, 1.0000 + 8.0000},
//    //    {0.0, 0.0000, 0.0000 + 8.0000},
//    //    {2.0, 0.0000, 0.0000 + 8.0000},
//    //    {2.0, 0.0000, 4.0000 + 8.0000},
//    //    {1.0, 0.0000, 3.0000 + 8.0000},
//    //    {2.0, 0.0000, 2.0000 + 8.0000},
//    //    {0.0, 0.0000, 4.0000 + 8.0000},
//    //    {1.0, 0.0000, 3.0000 + 8.0000},
//    //    {2.0, 0.0000, 4.0000 + 8.0000},
//    //    {0.0, 0.0000, 4.0000 + 8.0000},
//    //    {0.0, 0.0000, 2.0000 + 8.0000},
//    //    {1.0, 0.0000, 3.0000 + 8.0000},
//    //    {1.0, 0.0000, 3.0000 + 8.0000},
//    //    {0.0, 0.0000, 2.0000 + 8.0000},
//    //    {2.0, 0.0000, 2.0000 + 8.0000},
//    //    {2.0, 2.0000, 2.0000 + 12.0000},
//    //    {2.0, 1.0000, 1.0000 + 12.0000},
//    //    {2.0, 2.0000, 0.0000 + 12.0000},
//    //    {2.0, 0.0000, 2.0000 + 12.0000},
//    //    {2.0, 1.0000, 1.0000 + 12.0000},
//    //    {2.0, 2.0000, 2.0000 + 12.0000},
//    //    {2.0, 0.0000, 2.0000 + 12.0000},
//    //    {2.0, 0.0000, 0.0000 + 12.0000},
//    //    {2.0, 1.0000, 1.0000 + 12.0000},
//    //    {2.0, 1.0000, 1.0000 + 12.0000},
//    //    {2.0, 0.0000, 0.0000 + 12.0000},
//    //    {2.0, 2.0000, 0.0000 + 12.0000},
//    //    {2.0, 2.0000, 4.0000 + 12.0000},
//    //    {2.0, 1.0000, 3.0000 + 12.0000},
//    //    {2.0, 2.0000, 2.0000 + 12.0000},
//    //    {2.0, 0.0000, 4.0000 + 12.0000},
//    //    {2.0, 1.0000, 3.0000 + 12.0000},
//    //    {2.0, 2.0000, 4.0000 + 12.0000},
//    //    {2.0, 0.0000, 4.0000 + 12.0000},
//    //    {2.0, 0.0000, 2.0000 + 12.0000},
//    //    {2.0, 1.0000, 3.0000 + 12.0000},
//    //    {2.0, 1.0000, 3.0000 + 12.0000},
//    //    {2.0, 0.0000, 2.0000 + 12.0000},
//    //    {2.0, 2.0000, 2.0000 + 12.0000},
//    //    {0.0, 0.0000, 2.0000 + 12.0000},
//    //    {0.0, 1.0000, 1.0000 + 12.0000},
//    //    {0.0, 0.0000, 0.0000 + 12.0000},
//    //    {0.0, 1.0000, 1.0000 + 12.0000},
//    //    {0.0, 0.0000, 2.0000 + 12.0000},
//    //    {0.0, 2.0000, 2.0000 + 12.0000},
//    //    {0.0, 2.0000, 2.0000 + 12.0000},
//    //    {0.0, 2.0000, 0.0000 + 12.0000},
//    //    {0.0, 1.0000, 1.0000 + 12.0000},
//    //    {0.0, 1.0000, 1.0000 + 12.0000},
//    //    {0.0, 2.0000, 0.0000 + 12.0000},
//    //    {0.0, 0.0000, 0.0000 + 12.0000},
//    //    {0.0, 0.0000, 4.0000 + 12.0000},
//    //    {0.0, 1.0000, 3.0000 + 12.0000},
//    //    {0.0, 0.0000, 2.0000 + 12.0000},
//    //    {0.0, 1.0000, 3.0000 + 12.0000},
//    //    {0.0, 0.0000, 4.0000 + 12.0000},
//    //    {0.0, 2.0000, 4.0000 + 12.0000},
//    //    {0.0, 2.0000, 4.0000 + 12.0000},
//    //    {0.0, 2.0000, 2.0000 + 12.0000},
//    //    {0.0, 1.0000, 3.0000 + 12.0000},
//    //    {0.0, 1.0000, 3.0000 + 12.0000},
//    //    {0.0, 2.0000, 2.0000 + 12.0000},
//    //    {0.0, 0.0000, 2.0000 + 12.0000},
//    //    {0.0, 2.0000, 0.0000 + 12.0000},
//    //    {0.0, 2.0000, 2.0000 + 12.0000},
//    //    {1.0, 2.0000, 1.0000 + 12.0000},
//    //    {1.0, 2.0000, 1.0000 + 12.0000},
//    //    {2.0, 2.0000, 0.0000 + 12.0000},
//    //    {0.0, 2.0000, 0.0000 + 12.0000},
//    //    {2.0, 2.0000, 2.0000 + 12.0000},
//    //    {2.0, 2.0000, 0.0000 + 12.0000},
//    //    {1.0, 2.0000, 1.0000 + 12.0000},
//    //    {1.0, 2.0000, 1.0000 + 12.0000},
//    //    {0.0, 2.0000, 2.0000 + 12.0000},
//    //    {2.0, 2.0000, 2.0000 + 12.0000},
//    //    {0.0, 2.0000, 4.0000 + 12.0000},
//    //    {1.0, 2.0000, 3.0000 + 12.0000},
//    //    {0.0, 2.0000, 2.0000 + 12.0000},
//    //    {2.0, 2.0000, 4.0000 + 12.0000},
//    //    {1.0, 2.0000, 3.0000 + 12.0000},
//    //    {0.0, 2.0000, 4.0000 + 12.0000},
//    //    {2.0, 2.0000, 4.0000 + 12.0000},
//    //    {2.0, 2.0000, 2.0000 + 12.0000},
//    //    {1.0, 2.0000, 3.0000 + 12.0000},
//    //    {1.0, 2.0000, 3.0000 + 12.0000},
//    //    {2.0, 2.0000, 2.0000 + 12.0000},
//    //    {0.0, 2.0000, 2.0000 + 12.0000},
//    //    {2.0, 0.0000, 2.0000 + 12.0000},
//    //    {1.0, 0.0000, 1.0000 + 12.0000},
//    //    {2.0, 0.0000, 0.0000 + 12.0000},
//    //    {0.0, 0.0000, 2.0000 + 12.0000},
//    //    {1.0, 0.0000, 1.0000 + 12.0000},
//    //    {2.0, 0.0000, 2.0000 + 12.0000},
//    //    {0.0, 0.0000, 2.0000 + 12.0000},
//    //    {0.0, 0.0000, 0.0000 + 12.0000},
//    //    {1.0, 0.0000, 1.0000 + 12.0000},
//    //    {1.0, 0.0000, 1.0000 + 12.0000},
//    //    {0.0, 0.0000, 0.0000 + 12.0000},
//    //    {2.0, 0.0000, 0.0000 + 12.0000},
//    //    {2.0, 0.0000, 4.0000 + 12.0000},
//    //    {1.0, 0.0000, 3.0000 + 12.0000},
//    //    {2.0, 0.0000, 2.0000 + 12.0000},
//    //    {0.0, 0.0000, 4.0000 + 12.0000},
//    //    {1.0, 0.0000, 3.0000 + 12.0000},
//    //    {2.0, 0.0000, 4.0000 + 12.0000},
//    //    {0.0, 0.0000, 4.0000 + 12.0000},
//    //    {0.0, 0.0000, 2.0000 + 12.0000},
//    //    {1.0, 0.0000, 3.0000 + 12.0000},
//    //    {1.0, 0.0000, 3.0000 + 12.0000},
//    //    {0.0, 0.0000, 2.0000 + 12.0000},
//    //    {2.0, 0.0000, 2.0000 + 12.0000},
//    //    {2.0, 2.0000, 2.0000 + 16.0000},
//    //    {2.0, 1.0000, 1.0000 + 16.0000},
//    //    {2.0, 2.0000, 0.0000 + 16.0000},
//    //    {2.0, 0.0000, 2.0000 + 16.0000},
//    //    {2.0, 1.0000, 1.0000 + 16.0000},
//    //    {2.0, 2.0000, 2.0000 + 16.0000},
//    //    {2.0, 0.0000, 2.0000 + 16.0000},
//    //    {2.0, 0.0000, 0.0000 + 16.0000},
//    //    {2.0, 1.0000, 1.0000 + 16.0000},
//    //    {2.0, 1.0000, 1.0000 + 16.0000},
//    //    {2.0, 0.0000, 0.0000 + 16.0000},
//    //    {2.0, 2.0000, 0.0000 + 16.0000},
//    //    {2.0, 2.0000, 4.0000 + 16.0000},
//    //    {2.0, 1.0000, 3.0000 + 16.0000},
//    //    {2.0, 2.0000, 2.0000 + 16.0000},
//    //    {2.0, 0.0000, 4.0000 + 16.0000},
//    //    {2.0, 1.0000, 3.0000 + 16.0000},
//    //    {2.0, 2.0000, 4.0000 + 16.0000},
//    //    {2.0, 0.0000, 4.0000 + 16.0000},
//    //    {2.0, 0.0000, 2.0000 + 16.0000},
//    //    {2.0, 1.0000, 3.0000 + 16.0000},
//    //    {2.0, 1.0000, 3.0000 + 16.0000},
//    //    {2.0, 0.0000, 2.0000 + 16.0000},
//    //    {2.0, 2.0000, 2.0000 + 16.0000},
//    //    {0.0, 0.0000, 2.0000 + 16.0000},
//    //    {0.0, 1.0000, 1.0000 + 16.0000},
//    //    {0.0, 0.0000, 0.0000 + 16.0000},
//    //    {0.0, 1.0000, 1.0000 + 16.0000},
//    //    {0.0, 0.0000, 2.0000 + 16.0000},
//    //    {0.0, 2.0000, 2.0000 + 16.0000},
//    //    {0.0, 2.0000, 2.0000 + 16.0000},
//    //    {0.0, 2.0000, 0.0000 + 16.0000},
//    //    {0.0, 1.0000, 1.0000 + 16.0000},
//    //    {0.0, 1.0000, 1.0000 + 16.0000},
//    //    {0.0, 2.0000, 0.0000 + 16.0000},
//    //    {0.0, 0.0000, 0.0000 + 16.0000},
//    //    {0.0, 0.0000, 4.0000 + 16.0000},
//    //    {0.0, 1.0000, 3.0000 + 16.0000},
//    //    {0.0, 0.0000, 2.0000 + 16.0000},
//    //    {0.0, 1.0000, 3.0000 + 16.0000},
//    //    {0.0, 0.0000, 4.0000 + 16.0000},
//    //    {0.0, 2.0000, 4.0000 + 16.0000},
//    //    {0.0, 2.0000, 4.0000 + 16.0000},
//    //    {0.0, 2.0000, 2.0000 + 16.0000},
//    //    {0.0, 1.0000, 3.0000 + 16.0000},
//    //    {0.0, 1.0000, 3.0000 + 16.0000},
//    //    {0.0, 2.0000, 2.0000 + 16.0000},
//    //    {0.0, 0.0000, 2.0000 + 16.0000},
//    //    {0.0, 2.0000, 0.0000 + 16.0000},
//    //    {0.0, 2.0000, 2.0000 + 16.0000},
//    //    {1.0, 2.0000, 1.0000 + 16.0000},
//    //    {1.0, 2.0000, 1.0000 + 16.0000},
//    //    {2.0, 2.0000, 0.0000 + 16.0000},
//    //    {0.0, 2.0000, 0.0000 + 16.0000},
//    //    {2.0, 2.0000, 2.0000 + 16.0000},
//    //    {2.0, 2.0000, 0.0000 + 16.0000},
//    //    {1.0, 2.0000, 1.0000 + 16.0000},
//    //    {1.0, 2.0000, 1.0000 + 16.0000},
//    //    {0.0, 2.0000, 2.0000 + 16.0000},
//    //    {2.0, 2.0000, 2.0000 + 16.0000},
//    //    {0.0, 2.0000, 4.0000 + 16.0000},
//    //    {1.0, 2.0000, 3.0000 + 16.0000},
//    //    {0.0, 2.0000, 2.0000 + 16.0000},
//    //    {2.0, 2.0000, 4.0000 + 16.0000},
//    //    {1.0, 2.0000, 3.0000 + 16.0000},
//    //    {0.0, 2.0000, 4.0000 + 16.0000},
//    //    {2.0, 2.0000, 4.0000 + 16.0000},
//    //    {2.0, 2.0000, 2.0000 + 16.0000},
//    //    {1.0, 2.0000, 3.0000 + 16.0000},
//    //    {1.0, 2.0000, 3.0000 + 16.0000},
//    //    {2.0, 2.0000, 2.0000 + 16.0000},
//    //    {0.0, 2.0000, 2.0000 + 16.0000},
//    //    {2.0, 0.0000, 2.0000 + 16.0000},
//    //    {1.0, 0.0000, 1.0000 + 16.0000},
//    //    {2.0, 0.0000, 0.0000 + 16.0000},
//    //    {0.0, 0.0000, 2.0000 + 16.0000},
//    //    {1.0, 0.0000, 1.0000 + 16.0000},
//    //    {2.0, 0.0000, 2.0000 + 16.0000},
//    //    {0.0, 0.0000, 2.0000 + 16.0000},
//    //    {0.0, 0.0000, 0.0000 + 16.0000},
//    //    {1.0, 0.0000, 1.0000 + 16.0000},
//    //    {1.0, 0.0000, 1.0000 + 16.0000},
//    //    {0.0, 0.0000, 0.0000 + 16.0000},
//    //    {2.0, 0.0000, 0.0000 + 16.0000},
//    //    {2.0, 0.0000, 4.0000 + 16.0000},
//    //    {1.0, 0.0000, 3.0000 + 16.0000},
//    //    {2.0, 0.0000, 2.0000 + 16.0000},
//    //    {0.0, 0.0000, 4.0000 + 16.0000},
//    //    {1.0, 0.0000, 3.0000 + 16.0000},
//    //    {2.0, 0.0000, 4.0000 + 16.0000},
//    //    {0.0, 0.0000, 4.0000 + 16.0000},
//    //    {0.0, 0.0000, 2.0000 + 16.0000},
//    //    {1.0, 0.0000, 3.0000 + 16.0000},
//    //    {1.0, 0.0000, 3.0000 + 16.0000},
//    //    {0.0, 0.0000, 2.0000 + 16.0000},
//    //    {2.0, 0.0000, 2.0000 + 16.0000 }
//    //};
//    //std::vector<InstElemento> elementos;// =
//    //{
//    //    /*{1, 2, 3},
//    //    {4, 5, 6},
//    //    {7, 8, 9},
//    //    {10, 11, 12},
//    //    {13, 14, 15},
//    //    {16, 17, 18},
//    //    {19, 20, 21},
//    //    {22, 23, 24},
//    //    {25, 26, 27},
//    //    { 28, 29, 30},
//    //    { 31, 32, 33},
//    //    { 34, 35, 36},
//    //    { 37, 38, 39},
//    //    { 40, 41, 42},
//    //    { 43, 44, 45},
//    //    { 46, 47, 48},
//    //    { 49, 50, 51},
//    //    { 52, 53, 54},
//    //    { 55, 56, 57},
//    //    { 58, 59, 60},
//    //    { 61, 62, 63},
//    //    { 64, 65, 66},
//    //    { 67, 68, 69},
//    //    { 70, 71, 72},
//    //    { 73, 74, 75},
//    //    { 76, 77, 78},
//    //    { 79, 80, 81},
//    //    { 82, 83, 84},
//    //    { 85, 86, 87},
//    //    { 88, 89, 90},
//    //    { 91, 92, 93},
//    //    { 94, 95, 96},
//    //    { 97, 98, 99},
//    //    { 100, 101, 102},
//    //    { 103, 104, 105},
//    //    { 106, 107, 108},
//    //    { 109, 110, 111},
//    //    { 112, 113, 114},
//    //    { 115, 116, 117},
//    //    { 118, 119, 120},*/
//    //};
//    //for (int indice = 0; indice < pontos.size() / 3; indice++)
//    //{
//    //    const int ii = indice * 3;
//    //    elementos.push_back({ ii + 1, ii + 2, ii + 3 });
//    //}
//    //std::vector<CondContorno> deslPrescs =
//    //{
//    //    { 5,  3,  0 },
//    //    { 6,  3,  0 },
//    //    { 7,  3,  0 },
//    //    { 8,  3,  0 },
//    //    { 5,  2,  0 },
//    //    { 6,  2,  0 },
//    //    { 7,  2,  0 },
//    //    { 8,  2,  0 },
//    //    { 5,  1,  0 },
//    //    { 6,  1,  0 },
//    //    { 7,  1,  0 },
//    //    { 8,  1,  0 }
//    //};
//    //std::vector<CondContorno> forcsPrescs =
//    //{
//    //    /*{ 1,  2,   1.0 },
//    //    { 2,  2,   1.0 },
//    //    { 3,  2,   1.0 },
//    //    { 4,  2,   1.0 }, */
//    //    { 1,  3,   1.0 },
//    //    { 2,  3,   1.0 },
//    //    { 3,  3,   1.0 },
//    //    { 4,  3,   1.0 }/*,
//    //    { int(elementos.size()-3),  2,   1 },
//    //    { int(elementos.size()-2),  2,   1 },
//    //    { int(elementos.size()-1),  2,   1 },
//    //    { int(elementos.size()  ),    2,   1 },
//    //    { 5,  3,  -1.0 },
//    //    { 6,  3,  -1.0 },
//    //    { 7,  3,  -1.0 },
//    //    { 8,  3,  -1.0 }*/
//    //};
//
//    const int nivelTess = 0;
//
//    {
//        auto malhaTess = TriforceTesselation(elementos, pontos, nivelTess);
//        auto condsTess = CorrigeCondContornoTess(deslPrescs, forcsPrescs, nivelTess);
//
//        elementos = malhaTess.first;
//        pontos = malhaTess.second;
//
//        deslPrescs = condsTess.first;
//        forcsPrescs = condsTess.second;
//    }


    /*std::cout << "Num elementos: " << malha.cElementos.size() << std::endl;
    std::cout << "Num nodes: " << malha.cPontosInternos.size() << std::endl;

    if (malha.cPontosInternos.size() > 2000)
    {
        std::cout << "Pressione enter para continuar..." << std::endl;
        char c = 0;
        std::cin >> c;
    }*/


    //MalhaTriangularLinearDescontinua malha(pontos, elementos, forcsPrescs, deslPrescs);

    timer.Tock(idtMalha);

    timer.Tick(idtMatrizHG);

    FundSolPStar solFundPStar(v);
    FundSolUStar solFundUStar(v, G);

    PStarFunNoSing solFundPNoSingPStar(v);
    UStarFunNoSing solFundUNoSingUStar(v, G);

    HammerLinearDescTriangleIntegration hammerIntegration;
    SingularIntegrationLinearDescTriangle singIntegration;

    // elementos lineares -> três nós por elemento

    Matriz HPstar(3 * 3 * malha.cElementos.size(), 3 * 3 * malha.cElementos.size());
    Matriz GUStar(3 * 3 * malha.cElementos.size(), 3 * 3 * malha.cElementos.size());

    const int nelementos = malha.cElementos.size();

#ifndef _DEBUG
#pragma omp parallel for
#endif
    for (int i = 0; i < nelementos*3; i++) // para cada nó fonte i
    {
        for (int j = 0; j < nelementos*3; j++) // relaciona com todos os outros nós
        {
            // pulando três de uma vez para trabalhar com as submatrizes.
            const int ii = i * 3;
            const int jj = j * 3;

            const int indiceksi = j % 3 + 1;

            if (i != j)
            {
                for (int I = 1; I <= 3; I++)
                    for (int J = 1; J <= 3; J++)
                    {
                        const double raio = (malha.cElementos[j/3].triangulo.cCM - malha.cElementos[i/3].triangulo.cCM).Mod();

                        if (raio / malha.cElementos[j/3].triangulo.cLadoMedio < 4.0)
                        {
                            HPstar(ii + I - 1, jj + J - 1) = hammerIntegration.Integrate7PtsPStarSubElement(
                                malha.cElementos[j/3].triangulo,
                                malha.cPontosInternos[i/3].p123[i%3],
                                solFundPStar, I, J, indiceksi, 4, 1e-4);

                            GUStar(ii + I - 1, jj + J - 1) = hammerIntegration.Integrate7PtsUStarSubElement(
                                malha.cElementos[j/3].triangulo,
                                malha.cPontosInternos[i / 3].p123[i % 3],
                                solFundUStar, I, J, indiceksi, 4, 1e-4);

                            /*HPstar(ii + I - 1, jj + J - 1) = hammerIntegration.Integrate7PtsPStar(
                               malha.cElementos[j/3].triangulo,
                               malha.cElementos[i/3].triangulo.cCM,
                               solFundPStar, I, J, indiceksi);

                           GUStar(ii + I - 1, jj + J - 1) = hammerIntegration.Integrate7PtsUStar(
                               malha.cElementos[j/3].triangulo,
                               malha.cElementos[i/3].triangulo.cCM,
                               solFundUStar, I, J, indiceksi);*/
                        }
                        else
                        {

                            HPstar(ii + I - 1, jj + J - 1) = hammerIntegration.Integrate7PtsPStarSubElement(
                                malha.cElementos[j / 3].triangulo,
                                malha.cPontosInternos[i / 3].p123[i % 3],
                                solFundPStar, I, J, indiceksi, 0, 1e-4);

                            GUStar(ii + I - 1, jj + J - 1) = hammerIntegration.Integrate7PtsUStarSubElement(
                                malha.cElementos[j / 3].triangulo,
                                malha.cPontosInternos[i / 3].p123[i % 3],
                                solFundUStar, I, J, indiceksi, 0, 1e-4);

                            /*HPstar(ii + I - 1, jj + J - 1) = hammerIntegration.Integrate7PtsPStar(
                                malha.cElementos[j/3].triangulo,
                                malha.cElementos[i/3].triangulo.cCM,
                                solFundPStar, I, J, indiceksi);

                            GUStar(ii + I - 1, jj + J - 1) = hammerIntegration.Integrate7PtsUStar(
                                malha.cElementos[j/3].triangulo,
                                malha.cElementos[i/3].triangulo.cCM,
                                solFundUStar, I, J, indiceksi);*/
                        }

                    }
            }
            else
            {
                for (int I = 1; I <= 3; I++)
                    for (int J = 1; J <= 3; J++)
                    {
                        HPstar(ii + I - 1, jj + J - 1) = 0.0/*singIntegration.IntegratePStar(
                            malha.cElementos[j/3].triangulo,
                            malha.cPontosInternos[i/3].p123[i % 3],
                            solFundPNoSingPStar, I, J, indiceksi, 1e-0)*/;

						GUStar(ii + I - 1, jj + J - 1) = singIntegration.IntegrateUStar(
							malha.cElementos[j / 3].triangulo,
							malha.cPontosInternos[i / 3].p123[i % 3],
							solFundUNoSingUStar, I, J, indiceksi, 1e-0);

                    }
            }

        }
    }

    //MostrarMatriz(HPstar);

    /*for (int i = 0; i < 3 * nelementos; i++)
    {
        HPstar(i, i) += 0.5;
    }*/
    
    for (int i = 0; i < 3 * 3 * nelementos; i++)
    {
        double sum = 0.0;
        for (int j = 0; j < 3* 3 * nelementos; j++)
        {
            if (j != i)
                sum += HPstar(i, j);
        }


        HPstar(i, i) = -sum;

    }
    
    timer.Tock(idtMatrizHG);


    // consideração de: se não há condição de contorno, a força é zero.

    // A e B com colunas trocadas, para satisfazer B.C.
    // HU = GP -> Ax = By -> Ax = b

    timer.Tick(idtRearrSist);

    Matriz A = HPstar;
    Matriz B = GUStar;

    Matriz y(3 * 3 * nelementos, 1);

    for (size_t n = 0; n < malha.cPressoesPrescritas.size(); n++)
    {
        y((3 * 3 * (malha.cPressoesPrescritas[n].idEle - 1)) + (malha.cPressoesPrescritas[n].grauLib - 1) + 0, 0) = 
            malha.cPressoesPrescritas[n].val;
		y((3 * 3 * (malha.cPressoesPrescritas[n].idEle - 1)) + (malha.cPressoesPrescritas[n].grauLib - 1) + 3, 0) = 
            malha.cPressoesPrescritas[n].val;
		y((3 * 3 * (malha.cPressoesPrescritas[n].idEle - 1)) + (malha.cPressoesPrescritas[n].grauLib - 1) + 6, 0) = 
            malha.cPressoesPrescritas[n].val;
    }

    for (size_t n = 0; n < malha.cDeslsPrescritos.size(); n++)
    {
        y((3 * 3 * (malha.cDeslsPrescritos[n].idEle - 1)) + (malha.cDeslsPrescritos[n].grauLib - 1) + 0, 0) = 
            malha.cDeslsPrescritos[n].val;
		y((3 * 3 * (malha.cDeslsPrescritos[n].idEle - 1)) + (malha.cDeslsPrescritos[n].grauLib - 1) + 3, 0) = 
            malha.cDeslsPrescritos[n].val;
		y((3 * 3 * (malha.cDeslsPrescritos[n].idEle - 1)) + (malha.cDeslsPrescritos[n].grauLib - 1) + 6, 0) = 
            malha.cDeslsPrescritos[n].val;

        const int col1 = (3 * 3 * (malha.cDeslsPrescritos[n].idEle - 1)) + (malha.cDeslsPrescritos[n].grauLib - 1) + 0;
		const int col2 = (3 * 3 * (malha.cDeslsPrescritos[n].idEle - 1)) + (malha.cDeslsPrescritos[n].grauLib - 1) + 3;
		const int col3 = (3 * 3 * (malha.cDeslsPrescritos[n].idEle - 1)) + (malha.cDeslsPrescritos[n].grauLib - 1) + 6;

        A.SwapColNegative(B, col1);
		A.SwapColNegative(B, col2);
		A.SwapColNegative(B, col3);
    }


     //MostrarMatriz(HPstar, "HPStar");

    /*MostrarMatriz(GUStar, "GUStar");*/

    Matriz b = B * y;

    timer.Tock(idtRearrSist);

    timer.Tick(idtSolSistLin);

    Matriz X = ResSistLinearPALU(A, b);

    /*std::cout << "### GRAU 1 ### \n";
    for (size_t i = 0; i < nelementos; i++)
    {
        std::cout << "i: " << i << " " << X((i + 1) * 3 - 3, 0) << std::endl;
    }*/

	std::cout << "### GRAU 2 ### \n";
	for (size_t i = 0; i < nelementos * 3; i++)
	{
		std::cout << "i: " << i << " " << X((i + 1) * 3 - 2 + 0, 0) << std::endl;
		std::cout << "i: " << i << " " << X((i + 1) * 3 - 2 + 3, 0) << std::endl;
		std::cout << "i: " << i << " " << X((i + 1) * 3 - 2 + 6, 0) << std::endl;
	}

    std::cout << "### GRAU 3 ### \n";
    for (size_t i = 0; i < nelementos*3; i++)
    {
        std::cout << "i: " << i << " " << X((i + 1) * 3  - 1 + 0, 0) << std::endl;
		std::cout << "i: " << i << " " << X((i + 1) * 3  - 1 + 3, 0) << std::endl;
		std::cout << "i: " << i << " " << X((i + 1) * 3  - 1 + 6, 0) << std::endl;
    }

    timer.Tock(idtSolSistLin);

    LogMatrixToFile("Resultado.txt", X);

    //LogMatrixToFile("H.txt", HPstar);
    //LogMatrixToFile("G.txt", GUStar);
    //
	//LogMatrixToFile("Y.txt", y);

    timer.Tock(idtTotal);

    timer.WriteToCoutAllTickTock();

    system("PAUSE");

    return 0;
}